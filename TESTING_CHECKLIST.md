# ✅ רשימת בדיקות - מערכת ג'ורג'

## 🎯 בדיקות שצריך לבצע

### 1. **זיהוי "שילמתי" רק אחרי קישור** 💰

#### בדיקה A - לפני קישור תשלום:
```
אתה: היי
בוט: היי! אני ג'ורג'...
אתה: שילמתי
```
**תוצאה צפויה:** הבוט לא ימשיך לניתוח, ימשיך שיחה רגילה

#### בדיקה B - אחרי קישור תשלום:
```
... שיחה רגילה ...
בוט: [שולח קישור תשלום]
אתה: שילמתי
```
**תוצאה צפויה:** הבוט מנתח, שומר, שולח לדביר ✅

---

### 2. **אין כתובת/סרטון לפני תשלום** 📍

#### בדיקה A - קביעת אימון:
```
בוט: מתאים לך ביום חמישי בשעה 20:15?
אתה: כן
```
**תוצאה צפויה:** הבוט ישלח רק קישור תשלום, **ללא** כתובת או סרטון

#### בדיקה B - לקוח שואל "איפה?":
```
לקוח: איפה המכון?
```
**תוצאה צפויה:** הבוט יגיד שהכתובת תישלח אחרי התשלום

#### בדיקה C - אחרי "שילמתי":
```
לקוח: שילמתי
```
**תוצאה צפויה:** הבוט ישלח כתובת + סרטון הגעה ✅

---

### 3. **היסטוריית שיחה** 💬

#### בדיקה:
```
הודעה 1: "היי"
הודעה 2: "דני"
הודעה 3: "28"
הודעה 4: "יש לי ניסיון בקראטה"
הודעה 5: "מה המחיר?"
```

**תוצאה צפויה:** 
- הבוט זוכר את השם "דני"
- הבוט זוכר שהגיל 28
- הבוט זוכר שיש ניסיון בקראטה
- הבוט משתמש במידע הזה בתשובותיו

---

### 4. **שמירה למאגר** 💾

#### בדיקה A - במהלך השיחה:
```bash
# אחרי שהלקוח נתן שם וגיל:
./check_leads.sh
```
**תוצאה צפויה:** רואים את הלקוח עם שם, גיל, וסטטוס warm

#### בדיקה B - אחרי קישור תשלום:
```bash
# אחרי שנשלח קישור:
./check_leads.sh
```
**תוצאה צפויה:** סטטוס hot

#### בדיקה C - אחרי "שילמתי":
```bash
# אחרי שהלקוח אישר תשלום:
./check_leads.sh
```
**תוצאה צפויה:** 
- סטטוס: paid
- יש appointment בטבלת appointments
- יש סיכום JSON בטבלת chat_summaries

---

### 5. **הודעה לדביר** 📱

#### בדיקה:
אחרי שלקוח אומר "שילמתי" - בדוק שדביר קיבל הודעה במספר:
- **972559925657**

**תוצאה צפויה:** הודעה עם:
- שם מלא
- גיל
- ניסיון
- תאריך אימון
- שעה
- סיכום 3 שורות

---

## 🧪 תרחיש בדיקה מלא

```
1. אתה: "היי"
   → Cold Lead נוצר ✅
   
2. בוט: "היי! אני ג'ורג', העוזר של דביר 😊 איך קוראים לך?"
   
3. אתה: "דני"
   → name שמור למאגר ✅
   
4. בוט: "נעים להכיר דני. בן כמה?"
   
5. אתה: "28"
   → age שמור למאגר ✅
   → Warm Lead ✅
   
6. בוט: "מעולה! האימונים עבורך?"
   
7. אתה: "כן"
   
8. בוט: "יש לך ניסיון קודם?"
   
9. אתה: "שנתיים קראטה"
   → experience שמור למאגר ✅
   
10. בוט: "מעולה! ... מתאים לך ביום חמישי בשעה 20:15?"
   
11. אתה: "כן"
   
12. בוט: "מצוין! כדי לשמור את המקום, תשלום 25 ש\"ח:"
    בוט: "https://letts.co.il/payment/..." 
    → Hot Lead ✅
    → ⚠️ ללא כתובת או סרטון!
    
13. אתה: "שילמתי"
    → זוהה תשלום (כי יש קישור בהיסטוריה) ✅
    → GPT מנתח את כל השיחה ✅
    → שומר הכל למאגר ✅
    → שולח סיכום לדביר ✅
    → Paid + Appointment נוצר ✅
    
14. בוט: "מעולה! המקום שמור..."
    בוט: "📍 כתובת: הרצוג 12, הרצליה"
    בוט: "🎥 סרטון הגעה: ..."
    → כתובת וסרטון רק עכשיו! ✅
```

---

## 📊 לוגים צפויים

```
📬 התקבלה הודעת ווטסאפ מספר 1
✅ לקוח חדש נוצר (Cold Lead)
📝 זיהוי שם: דני
📝 זיהוי גיל: 28
✅ עודכנו 2 שדות עבור הלקוח
✅ ליד עודכן ל-WARM
🔥 ליד עודכן ל-HOT (קיבל קישור תשלום)
💰 תשלום זוהה (אחרי שליחת קישור)! מתחיל ניתוח שיחה...
✅ פרטי לקוח עודכנו - סטטוס: PAID
✅ אפוינטמנט נשמר בהצלחה: 10/10/2025 20:15
✅ סיכום נשלח לדביר
```

---

## ✅ רשימת בדיקות

- [ ] הבוט לא מזהה "שילמתי" לפני קישור תשלום
- [ ] הבוט מזהה "שילמתי" אחרי קישור תשלום
- [ ] הבוט לא שולח כתובת לפני קישור תשלום
- [ ] הבוט לא שולח סרטון הגעה לפני קישור תשלום
- [ ] הבוט שולח כתובת וסרטון רק אחרי "שילמתי"
- [ ] הבוט זוכר את כל ההיסטוריה
- [ ] שם נשמר למאגר
- [ ] גיל נשמר למאגר
- [ ] ניסיון נשמר למאגר
- [ ] סטטוס ליד מתעדכן: cold → warm → hot → paid
- [ ] appointment נשמר בטבלה
- [ ] סיכום JSON נשמר
- [ ] דביר מקבל הודעה עם כל הפרטים

---

## 🚀 להפעיל:

```bash
node server.js
```

---

## 🐛 אם משהו לא עובד:

### בדוק לוגים:
```bash
# במהלך ההרצה, תראה לוגים מפורטים
# חפש אחרי:
- "✅ לקוח חדש נוצר"
- "📝 זיהוי שם/גיל/ניסיון"
- "🔥 ליד עודכן ל-HOT"
- "💰 תשלום זוהה"
```

### בדוק מאגר:
```bash
./check_leads.sh
```

---

## 🎉 סיכום

כל השינויים פועלים! המערכת:
- ✅ זוכרת הכל
- ✅ מגינה מפני עקיפות
- ✅ מקצועית ומסודרת
- ✅ שומרת הכל למאגר

**בהצלחה! 🚀**

